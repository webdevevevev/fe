import{d as k,a as x,u as S,r as N,i as c,b as r,c as D,e,w as s,F as E,U as V,o as T,j as h,I as B,f as w,p as j,g as F,h as M,v as O,E as u,k as P,_ as $}from"./index-99e3b7e1.js";import{_ as z}from"./CitySelect.vue_vue_type_script_setup_true_lang-058170af.js";const R=d=>(j("data-v-d04d9a6d"),d=d(),F(),d),q=R(()=>M("h2",null,"注册",-1)),A=k({__name:"Signup",setup(d){const g=x(),v=S(),l=N(new V),i=c(-1),p=c(-1),_=c("");async function C(){const m=await O(l);if(m.length){for(const{constraints:a}of m)if(a)for(const f of Object.values(a))u.error({showClose:!0,message:f});return console.error(m)}if(i.value<0){u.error({showClose:!0,message:"请选择省份"});return}if(p.value<0){u.error({showClose:!0,message:"请选择城市"});return}if(_.value!==l.pwd){u.error({showClose:!0,message:"密码不一致"});return}const o=v.state.provinces[i.value];l.provinceId=o.id,l.cityId=o.cities[p.value].id;let n;try{n=await P(l,!1)}catch(a){return u.error({showClose:!0,message:a.message}),console.error(a)}n instanceof V?(v.commit("signin",n),u.success({showClose:!0,message:"注册成功"}),g.push({name:"signin"})):u.error({showClose:!0,message:n})}return(m,o)=>{const n=r("el-input"),a=r("el-form-item"),f=r("el-option"),y=r("el-select"),b=r("el-button"),I=r("router-link"),U=r("el-form");return T(),D(E,null,[q,e(U,{model:l,"label-width":"80px"},{default:s(()=>[e(a,{label:"用户名"},{default:s(()=>[e(n,{modelValue:l.nickname,"onUpdate:modelValue":o[0]||(o[0]=t=>l.nickname=t)},null,8,["modelValue"])]),_:1}),e(a,{label:"密码"},{default:s(()=>[e(n,{modelValue:l.pwd,"onUpdate:modelValue":o[1]||(o[1]=t=>l.pwd=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(a,{label:"重复密码"},{default:s(()=>[e(n,{modelValue:_.value,"onUpdate:modelValue":o[2]||(o[2]=t=>_.value=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(a,{label:"姓名"},{default:s(()=>[e(n,{modelValue:l.name,"onUpdate:modelValue":o[3]||(o[3]=t=>l.name=t)},null,8,["modelValue"])]),_:1}),e(a,{label:"证件类型"},{default:s(()=>[e(y,{modelValue:l.IDCardType,"onUpdate:modelValue":o[4]||(o[4]=t=>l.IDCardType=t)},{default:s(()=>[e(f,{label:"中华人民共和国居民身份证",value:h(B).zhCN},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"证件号码"},{default:s(()=>[e(n,{modelValue:l.IDCardNo,"onUpdate:modelValue":o[5]||(o[5]=t=>l.IDCardNo=t)},null,8,["modelValue"])]),_:1}),e(a,{label:"手机号码"},{default:s(()=>[e(n,{modelValue:l.phone,"onUpdate:modelValue":o[6]||(o[6]=t=>l.phone=t)},null,8,["modelValue"])]),_:1}),e(a,{label:"用户简介"},{default:s(()=>[e(n,{modelValue:l.intro,"onUpdate:modelValue":o[7]||(o[7]=t=>l.intro=t)},null,8,["modelValue"])]),_:1}),e(a,{label:"注册城市"},{default:s(()=>[e(z,{province:i.value,"onUpdate:province":o[8]||(o[8]=t=>i.value=t),city:p.value,"onUpdate:city":o[9]||(o[9]=t=>p.value=t)},null,8,["province","city"])]),_:1}),e(a,null,{default:s(()=>[e(b,{type:"primary",onClick:C},{default:s(()=>[w("注册")]),_:1})]),_:1}),e(a,null,{default:s(()=>[e(I,{to:"/signin",class:"link"},{default:s(()=>[w("已有账号？点此登录")]),_:1})]),_:1})]),_:1},8,["model"])],64)}}});const J=$(A,[["__scopeId","data-v-d04d9a6d"]]);export{J as default};
