import{d as k,a as x,u as S,r as N,i as c,b as r,c as D,w as a,U as V,o as h,e as o,j as T,I as B,f as w,v as E,E as u,k as j,p as M,g as O,h as P,_ as $}from"./index-ac661111.js";import{_ as z}from"./CitySelect.vue_vue_type_script_setup_true_lang-c5c69df5.js";const R=d=>(M("data-v-36942816"),d=d(),O(),d),q=R(()=>P("h2",{class:"header"},"注册",-1)),A=k({__name:"Signup",setup(d){const g=x(),v=S(),l=N(new V),i=c(-1),p=c(-1),_=c("");async function C(){const m=await E(l);if(m.length){for(const{constraints:s}of m)if(s)for(const f of Object.values(s))u.error({showClose:!0,message:f});return console.error(m)}if(i.value<0){u.error({showClose:!0,message:"请选择省份"});return}if(p.value<0){u.error({showClose:!0,message:"请选择城市"});return}if(_.value!==l.pwd){u.error({showClose:!0,message:"密码不一致"});return}const e=v.state.provinces[i.value];l.provinceId=e.id,l.cityId=e.cities[p.value].id;let n;try{n=await j(l,!1)}catch(s){return u.error({showClose:!0,message:s.message}),console.error(s)}n instanceof V?(v.commit("signin",n),u.success({showClose:!0,message:"注册成功"}),g.push({name:"signin"})):u.error({showClose:!0,message:n})}return(m,e)=>{const n=r("el-input"),s=r("el-form-item"),f=r("el-option"),y=r("el-select"),b=r("el-button"),I=r("router-link"),U=r("el-form");return h(),D(U,{class:"form",model:l,"label-width":"80px"},{default:a(()=>[q,o(s,{label:"用户名"},{default:a(()=>[o(n,{modelValue:l.nickname,"onUpdate:modelValue":e[0]||(e[0]=t=>l.nickname=t)},null,8,["modelValue"])]),_:1}),o(s,{label:"密码"},{default:a(()=>[o(n,{modelValue:l.pwd,"onUpdate:modelValue":e[1]||(e[1]=t=>l.pwd=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(s,{label:"重复密码"},{default:a(()=>[o(n,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(s,{label:"姓名"},{default:a(()=>[o(n,{modelValue:l.name,"onUpdate:modelValue":e[3]||(e[3]=t=>l.name=t)},null,8,["modelValue"])]),_:1}),o(s,{label:"证件类型"},{default:a(()=>[o(y,{modelValue:l.IDCardType,"onUpdate:modelValue":e[4]||(e[4]=t=>l.IDCardType=t)},{default:a(()=>[o(f,{label:"中华人民共和国居民身份证",value:T(B).zhCN},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),o(s,{label:"证件号码"},{default:a(()=>[o(n,{modelValue:l.IDCardNo,"onUpdate:modelValue":e[5]||(e[5]=t=>l.IDCardNo=t)},null,8,["modelValue"])]),_:1}),o(s,{label:"手机号码"},{default:a(()=>[o(n,{modelValue:l.phone,"onUpdate:modelValue":e[6]||(e[6]=t=>l.phone=t)},null,8,["modelValue"])]),_:1}),o(s,{label:"用户简介"},{default:a(()=>[o(n,{modelValue:l.intro,"onUpdate:modelValue":e[7]||(e[7]=t=>l.intro=t)},null,8,["modelValue"])]),_:1}),o(s,{label:"注册城市"},{default:a(()=>[o(z,{province:i.value,"onUpdate:province":e[8]||(e[8]=t=>i.value=t),city:p.value,"onUpdate:city":e[9]||(e[9]=t=>p.value=t)},null,8,["province","city"])]),_:1}),o(s,null,{default:a(()=>[o(b,{type:"primary",onClick:C},{default:a(()=>[w("注册")]),_:1})]),_:1}),o(s,null,{default:a(()=>[o(I,{to:"/signin",class:"link"},{default:a(()=>[w("已有账号？点此登录")]),_:1})]),_:1})]),_:1},8,["model"])}}});const H=$(A,[["__scopeId","data-v-36942816"]]);export{H as default};
