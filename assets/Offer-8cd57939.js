import{d as x,a as A,r as h,E as m,b as g,c as p,e as f,h as u,F as P,l as B,m as D,O as $,n as N,U as R,q as Y,t as z,S as c,o as r,w as b,x as w,j as d,y as E,z as y,A as F,C as M,p as q,g as H,B as L,D as U,G as V,_ as G}from"./index-7c357ab0.js";import{P as J}from"./Post-33cff907.js";const K=n=>(q("data-v-a5bb2a61"),n=n(),H(),n),Q={class:"main"},T={class:"aside"},W=K(()=>u("h3",{class:"aside-header"},"欢迎来列表",-1)),X={key:0,class:"list"},Z=x({__name:"Offer",props:{id:{type:[Number,String],required:!0}},setup(n){const v=n;A();const i=h(new $);i.id=Number(v.id);const o=h([]);async function S(e,a){const s=await N(e.id);s.user=new R,s.user.id=s.userId,delete s.userId,Object.assign(e,s);const _=await Promise.all(e.answerIds.map(t=>Y(t)));a.push(..._.filter(C));for(const t of a)z(t.user.id).then(l=>{t.user=l})}S(i,o).catch(e=>{m.error({showClose:!0,message:e.message}),console.error(e)});function C({state:e}){return e===c.pending||e===c.accepted}function j(e){o.push(e)}async function I(e){const a=o[e];try{await L(a.id)}catch(s){m.error({showClose:!0,message:s.message}),console.error(s)}a.state=c.accepted,i.state=U.fulfilled}async function O(e){const a=o[e];try{await V(a.id)}catch(s){m.error({showClose:!0,message:s.message}),console.error(s)}a.state=c.rejected,o.splice(e,1)}return(e,a)=>{const s=g("el-tooltip"),_=g("el-empty");return r(),p("main",Q,[f(J,{base:i,onPublish:j,class:"article"},null,8,["base"]),u("aside",T,[W,o.length?(r(),p("ul",X,[(r(!0),p(P,null,B(o,(t,l)=>(r(),p("li",{key:t.id,class:"answer-preview"},[f(M,{base:t,onAccept:k=>I(l),onReject:k=>O(l),shadow:"hover"},{footer:b(()=>[u("span",null,w(d(E)(t.ctime,"YYYY-MM-DD HH:mm").value),1),f(s,{content:`状态：${d(y)[t.state]}`},{default:b(()=>[u("span",{class:F(["state",d(c)[t.state]])},w(d(y)[t.state]),3)]),_:2},1032,["content"])]),_:2},1032,["base","onAccept","onReject"])]))),128))])):(r(),D(_,{key:1,description:"列表为空","image-size":100}))])])}}});const te=G(Z,[["__scopeId","data-v-a5bb2a61"]]);export{te as default};
