import{d as D,r as y,E as C,i as F,b as i,c as b,h as o,t as r,e as s,w as t,j as d,F as k,k as V,O as M,q as U,x as G,y as H,A as J,o as w,f as g,z as S,B as K,S as R,C as $,D as T,G as Q,H as W,p as X,g as Y,J as Z,K as ee,L as se,_ as te}from"./index-0e7aa9b2.js";const oe=m=>(X("data-v-2b8b86cb"),m=m(),Y(),m),ae={class:"main"},ne={class:"article"},le={class:"header"},ce={class:"title"},re={class:"spans"},ie={class:"price"},de={class:"time"},_e={class:"ctime"},ue={class:"mtime"},pe={class:"expire"},me={class:"desc"},fe={class:"aside"},he=oe(()=>o("h3",{class:"aside-header"},"欢迎来列表",-1)),be={class:"list"},we={class:"card-title"},ge={class:"card-footer"},ye={class:"dialog-footer"},ve=D({__name:"Offer",props:{id:{type:[Number,String],required:!0}},setup(m){const A=m,n=y(new M);n.id=Number(A.id);const f=y([]);async function I(a,e){const l=await U(a.id);Object.assign(a,l);const _=await Promise.all(l.answerIds.map(p=>G(p)));e.push(..._);for(const p of e)H(p.user.id).then(v=>{p.user=v})}I(n,f).catch(a=>{C.error({showClose:!0,message:a.message}),console.error(a)});async function O(a){const e=f[a];try{await Z(e.id)}catch(l){C.error({showClose:!0,message:l.message}),console.error(l)}e.state=ee.rejected,f.splice(a,1)}const h=F(!1);let u=y(x());function x(){const a=new J;return a.userId=1,a.offerId=n.id,a}async function j(){h.value=!1;let a;try{a=await se(u)}catch(l){return C.error({showClose:!0,message:l.message}),console.error(l)}const e=u;u=y(x()),e.id=a,f.push(e)}return(a,e)=>{const l=i("el-tooltip"),_=i("el-button"),p=i("el-icon"),v=i("el-button-group"),N=i("el-text"),B=i("el-card"),L=i("el-input"),z=i("el-form-item"),E=i("el-form"),P=i("el-dialog");return w(),b(k,null,[o("main",ae,[o("article",ne,[o("header",le,[o("h2",ce,r(n.title),1),o("div",re,[s(l,{content:`类型：${d(S)[n.type]}`},{default:t(()=>[g(r(d(S)[n.type]),1)]),_:1},8,["content"]),s(l,{content:`状态：${d($)[n.state]}`},{default:t(()=>[o("span",{class:K(["state",d(R)[n.state]])},r(d($)[n.state]),3)]),_:1},8,["content"]),o("span",ie,r(n.price)+"元",1)]),s(_,{type:"primary",class:"publish-btn",onClick:e[0]||(e[0]=c=>h.value=!0)},{default:t(()=>[g(" 发布响应 ")]),_:1})]),o("div",de,[o("span",_e,"发布于"+r(n.ctime),1),o("span",ue,"修改于"+r(n.mtime),1),o("p",pe,"过期于"+r(n.expire),1)]),o("p",me,r(n.desc),1),(w(!0),b(k,null,V(n.files,c=>(w(),b("p",{key:c},r(c),1))),128))]),o("aside",fe,[he,o("ul",be,[(w(!0),b(k,null,V(f,(c,q)=>(w(),b("li",{key:c.id,class:"answer-preview"},[s(B,{shadow:"hover"},{header:t(()=>[o("h4",we,r(c.user.nickname),1),s(v,{size:"small",onClick:e[2]||(e[2]=T(()=>{},["stop"]))},{default:t(()=>[s(l,{content:"接受"},{default:t(()=>[s(_,{icon:d(Q),onClick:e[1]||(e[1]=()=>{})},null,8,["icon"])]),_:1}),s(l,{content:"拒绝"},{default:t(()=>[s(_,{class:"reject-btn",onClick:Ce=>O(q)},{default:t(()=>[s(p,{color:"red"},{default:t(()=>[s(d(W))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),footer:t(()=>[o("div",ge,r(c.ctime),1)]),default:t(()=>[s(N,{"line-clamp":2,class:"answer-desc"},{default:t(()=>[g(r(c.desc),1)]),_:2},1024)]),_:2},1024)]))),128))])])]),s(P,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=c=>h.value=c),title:"发布响应"},{footer:t(()=>[o("span",ye,[s(_,{onClick:e[4]||(e[4]=c=>h.value=!1)},{default:t(()=>[g("取消")]),_:1}),s(_,{type:"primary",onClick:j},{default:t(()=>[g(" 提交 ")]),_:1})])]),default:t(()=>[s(E,{model:d(u),class:"publish-form","label-width":"80px"},{default:t(()=>[s(z,{label:"描述"},{default:t(()=>[s(L,{modelValue:d(u).desc,"onUpdate:modelValue":e[3]||(e[3]=c=>d(u).desc=c),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});const xe=te(ve,[["__scopeId","data-v-2b8b86cb"]]);export{xe as default};
